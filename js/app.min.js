String.prototype.compile=function(a){return this.replace(/[{]([^}]+)[}]/g,function(b,c){return a[c]})},function(a){a.fn.smartVideo=function(b){var c,d,e=Object.assign({autoSize:!0,chapters:[],onStart:!1,onPlay:!1,onPause:!1,onComplete:!1,mode:"embed",hideControls:!1,hideChapterMenu:!1},b),f=this,g=f[0],h={ready:!1,init:function(){if(f.wrap("<div class='smart-video {mode}'></div>".compile({mode:e.mode})),c=f.closest(".smart-video"),c.prepend("<i class='fa fa-spin fa-cog loader'></i>"),f.removeProp("controls"),f.prop("preload","metadata"),f.attr("playsinline",!0),f.attr("oncontextmenu","return false;"),e.autoSize&&h.resize(),f.after("<div class='control-bar'> <div class='controls'> <a class='fa fa-play'></a> <a class='fa fa-pause hide'></a> <a class='fa fa-volume-up'></a> <a class='fa fa-arrows-alt'></a> </div> <div class='progress'> <div class='inner'></div> </div> <div class='clearfix'></div> </div>"),f.after("<div class='chapter-menu'></div>"),"fullscreen"===e.mode){f.after("<a class='fa fa-list-ul toggle' data-target='.chapter-menu' data-original-icon='fa-list-ul' href='#'></a>"),f.after("<a class='fa fa-toggle-off toggle' data-target='.control-bar' data-original-icon='fa-toggle-off' href='#'></a>")}d={play:c.find(".fa-play"),pause:c.find(".fa-pause"),progressBar:c.find(".progress"),progress:c.find(".progress .inner"),chapterMenu:c.find(".chapter-menu"),controls:c.find(".control-bar")},h.binds()},resize:function(){var a=f.width(),b=.5625*a;f.height(b)},binds:function(){e.autoSize&&a(window).resize(h.resize),d.play.on("click",function(a){a.preventDefault(),h.ready&&g.play()}),d.pause.on("click",function(a){a.preventDefault(),h.ready&&g.pause()}),g.readyState>=2?h.playerSetup():f.on("loadedmetadata",h.playerSetup),f.on("click",function(a){h.toggleControls("show"),h.playing?g.pause():(g.play(),setTimeout(function(){h.toggleControls("hide")},1500))}),f.on("play playing",function(a){d.play.addClass("hide"),d.pause.removeClass("hide"),h.playing=!0,h.started||(h.toggleControls("hide"),h.toggleChapterMenu("hide"),h.started=!0,"function"==typeof e.onStart&&e.onStart(a)),"function"==typeof e.onPlay&&e.onPlay(a)}),f.on("pause",function(a){d.play.removeClass("hide"),d.pause.addClass("hide"),h.playing=!1,"function"==typeof e.onPause&&e.onPause(a)}),f.on("timeupdate",function(a){if(h.ready){var b=g.currentTime,c=g.duration,e=Math.floor(b/c*100),f=d.chapterMenu.find("[data-seconds='{seconds}']".compile({seconds:Math.floor(b)}));d.progress.width(e+"%"),f.length>0&&(d.chapterMenu.find("a.chapter").removeClass("active"),f.addClass("active"))}}),f.on("ended",function(a){"function"==typeof e.onComplete&&e.onComplete(a)}),d.progressBar.on("click mousedown mouseup",function(b){b.preventDefault();var c=a(this).offset(),d=b.pageX-c.left,e=a(this).width(),f=d/e,h=g.duration*f;g.currentTime=h}),a("body").on("click",".chapter-menu > a.chapter",function(b){b.preventDefault();var c=a(this),d=c.data("seconds"),e=c.closest(".smart-video"),f=e.find("video")[0];f.currentTime=d,f.play()}),a("body").on("click",".toggle",function(b){b.preventDefault();var c=a(this),d=c.closest(".smart-video"),e=(d.find("video")[0],c.data("target"));c.data("original-icon"),d.find(e);switch(e){case".chapter-menu":h.toggleChapterMenu();break;case".control-bar":h.toggleControls()}})},toggleChapterMenu:function(a){var b=c.find("[data-target='.chapter-menu']"),e=b.data("original-icon"),f=d.chapterMenu;void 0===a&&(a=f.hasClass("active")?"hide":"show"),"show"===a?(f.addClass("active"),b.removeAttr("class").addClass("fa fa-close toggle")):(f.removeClass("active"),b.removeAttr("class").addClass("fa toggle").addClass(e))},toggleControls:function(a){var b=c.find("[data-target='.control-bar']"),e=b.data("original-icon"),f=d.controls;void 0===a&&(a=f.hasClass("active")?"hide":"show"),"show"===a?(f.addClass("active"),b.removeAttr("class").addClass("fa fa-close toggle")):(f.removeClass("active"),b.removeAttr("class").addClass("fa toggle").addClass(e))},getFrame:function(b,c){var d=document.createElement("canvas"),e=a(g).clone(!1,!1),f=0;if(h.checkiOS()&&(h.checkiOS()[0]<10||h.checkiOS()[1]<3))return c(!1),!1;e.on("loadedmetadata",function(){d.width=.25*e[0].videoWidth,d.height=.25*e[0].videoHeight,e[0].currentTime=b}),e.on("seeked",function(){d.getContext("2d").drawImage(e[0],0,0,d.width,d.height),f<2?(f++,e[0].currentTime=b):(e.remove(),"function"==typeof c&&c(d.toDataURL()))})},playerSetup:function(){a.each(e.chapters,function(){var a=this,b=g.duration,c=Math.floor(a.seconds/b*100);d.chapterMenu.append("<a class='chapter' href='#'></a>");var e=d.chapterMenu.find(".chapter").eq(-1);h.getFrame(a.seconds,function(b){d.progressBar.append("<a class='chapter' style='left: {pct}%' data-seconds='{seconds}'><div class='preview'><img src='{thumbnail}' /></div></a>".compile({pct:c,seconds:a.seconds,thumbnail:b})),e.attr("data-seconds",a.seconds).html("<div class='preview'><img src='{thumbnail}' /></div><div class='headline'>{title}</div><div class='description'>{desc}</div>".compile({seconds:a.seconds,thumbnail:b,title:a.title,desc:a.description}))})}),g.currentTime=0,h.ready=!0,c.addClass("ready"),e.hideChapterMenu||h.toggleChapterMenu("show"),e.hideControls||h.toggleControls("show")},checkiOS:function(){if(/iP(hone|od|ad)/.test(navigator.platform)){var a=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);return[parseInt(a[1],10),parseInt(a[2],10),parseInt(a[3]||0,10)]}return!1}};h.init()}}(jQuery),$(function(){$("video").smartVideo({autoPlay:!0,chapters:[{seconds:1,title:"Chapter 1",description:"Look at the pretty colors!"},{seconds:16,title:"Chapter 2",description:"Humor: Bird gets knocked out"},{seconds:27,title:"Chapter 3: Title Screen",description:"This is where the title finally shows up."},{seconds:41,title:"Chapter 4: The awakening",description:"Our hero awakens from his slumber"},{seconds:56,title:"Chapter 5: Starting the day",description:"After a nice neck crack, Buck sets out"}],mode:"fullscreen"})});